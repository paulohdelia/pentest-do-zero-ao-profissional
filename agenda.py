AGENDA = {
    'Paulo': {
        'tel': '98877-6655',
        'email': 'paulo@email.com',
        'endereco': 'rua xpto'
    },
    'José': {
        'tel': '98221-1673',
        'email': 'jose@email.com',
        'endereco': 'rua qwerty'
    },
    'Amanda': {
        'tel': '92132-4557',
        'email': 'amanda@email.com',
        'endereco': 'rua abcd'
    },
}

# Buscar contato ✅
# Criar contato ✅
# Excluir contato ✅
# Editar contato ✅
# Salvar agenda
# Exibir contato ✅
# Exibir agenda ✅
# Exportar agenda CSV


def buscar_contato(contato=None):
    if contato == None:
        print('Contato que deseja buscar:')
        contato = input()

    if contato in AGENDA:
        print_contato(contato)
    else:
        print_contato_nao_encontrado()


def ler_contato():
    print('Nome:')
    inputNome = input()

    print('Telefone:')
    inputTel = input()

    print('E-mail:')
    inputEmail = input()

    print('Endereço:')
    inputEndereco = input()

    return inputNome, inputTel, inputEmail, inputEndereco


def criar_editar_contato():
    inputNome, inputTel, inputEmail, inputEndereco = ler_contato()

    AGENDA[inputNome] = {
        'tel': inputTel,
        'email': inputEmail,
        'endereco': inputEndereco
    }

    print('--------------')
    print('Contato criado')
    print('--------------')
    buscar_contato(inputNome)


def excluir_contato(contato=None):
    if contato == None:
        print('Contato que deseja excluir:')
        contato = input()

    if contato in AGENDA:
        AGENDA.pop(contato)
        print('--------------')
        print('Contato excluído')
        print('--------------')
    else:
        print_contato_nao_encontrado()


def print_contato(contato):
    print('Nome:', contato)
    print('Telefone:', AGENDA[contato]['tel'])
    print('E-mail:', AGENDA[contato]['email'])
    print('Endereço:', AGENDA[contato]['endereco'])


def print_contato_nao_encontrado():
    print('Contato não encontrado.')


def exibir_agenda():
    for contato in AGENDA:
        print_contato(contato)
        print('_____________________')


def exportar_contatos():
    try:
        with open('agenda.csv', 'w') as arquivo:
            arquivo.write('nome,telefone,email,endereco\n')
            for contato in AGENDA:
                telefone = AGENDA[contato]['tel']
                email = AGENDA[contato]['email']
                endereco = AGENDA[contato]['endereco']
                arquivo.write(f'{contato},{telefone},{email},{endereco}\n')
            print('Agenda exportada com sucesso')
    except Exception as e:
        print('Erro ao exportar os contatos:', e)


def importar_contatos():
    try:
        with open('importar_contatos.csv', 'r') as arquivo:
            linhas = arquivo.readlines()
            linhas.pop(0)

            for linha in linhas:
                [contato, telefone, email, endereco] = linha.strip().split(',')

                AGENDA[contato] = {
                    'tel': telefone,
                    'email': email,
                    'endereco': endereco
                }

            print('Contatos importados\n')
            exibir_agenda()
    except FileNotFoundError:
        print('Arquivo não encontrado')
    except Exception:
        print('Erro inesperado')


def exibir_menu():
    print('--------------------------------')
    print('# 1. Buscar contato            #')
    print('# 2. Criar/Editar contato      #')
    print('# 3. Excluir contato           #')
    print('# 4. Exibir agenda             #')
    print('# 5. Salvar agenda             #')
    print('# 6. Exportar contatos         #')
    print('# 7. Importar contatos         #')
    print('# 0. Fechar agenda             #')
    print('--------------------------------')
    print('Escolha uma opção e aperte ENTER')
    print('--------------------------------')


def loop():
    while True:
        exibir_menu()

        inputMenu = input()

        if inputMenu == '1':
            buscar_contato()
        elif inputMenu == '2':
            criar_editar_contato()
        elif inputMenu == '3':
            excluir_contato()
        elif inputMenu == '4':
            exibir_agenda()
        elif inputMenu == '6':
            exportar_contatos()
        elif inputMenu == '7':
            importar_contatos()
        elif inputMenu == '0':
            print('Encerrando aplicação')
            break
        else:
            print('Escolha um comando válido')


loop()
